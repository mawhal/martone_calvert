lump.simple
# Data
data <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data.csv", stringsAsFactors = FALSE )
#metadata
meta<-read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv")
## read data files
# all data
ad <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data.csv")
# all metadata
am <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" )
## Data cleaning for Analysis -- consider moving part of this to another script
# remove 2011 data
am <- am[ am$Year != "2011", ]
# remove Meay Channel
am <- am[ am$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
ad[ duplicated(ad), ] # generalize this to look at particular columns
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
ad.simple <- ad %>%
group_by( UID, Taxon ) %>%
summarize( Abundance=sum(Abundance,na.rm=T))
ad.simple
## read data files
# all data
algae <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data_algae.csv")
# all metadata
algae_metadata <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" )
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv")
## Data cleaning for Analysis
# remove 2011 data
#algae_metadata <- algae_metadata[ algae_metadata$Year != "2011", ]
# remove Meay Channel
am <- algae_metadata[ algae_metadata$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
algae[ duplicated(algae), ] # generalize this to look at particular columns
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump.data %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
lump.simple
str$lump
str(lump)
# set options
options(stringsAsFactors = FALSE)
## read data files
# all data
algae <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data_algae.csv")
# all metadata
algae_metadata <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" )
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv")
## Data cleaning for Analysis
# remove 2011 data
#algae_metadata <- algae_metadata[ algae_metadata$Year != "2011", ]
# remove Meay Channel
am <- algae_metadata[ algae_metadata$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
algae[ duplicated(algae), ] # generalize this to look at particular columns
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump.data %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
lump.simple
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv")
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv", stringsAsFactors = FALSE)
head(lump)
## read data files
# all data
algae <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data_algae.csv", stringsAsFactors = FALSE)
# all metadata
algae_metadata <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" , stringsAsFactors = FALSE)
###Meta data is currently missing a quadrat from 2016 (Fifth Beach)
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv", stringsAsFactors = FALSE)
## Data cleaning for Analysis
# remove 2011 data
#algae_metadata <- algae_metadata[ algae_metadata$Year != "2011", ]
# remove Meay Channel
am <- algae_metadata[ algae_metadata$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
algae[ duplicated(algae), ] # generalize this to look at particular columns
#
#lump.data <- data.frame(cbind(UID=lump$UID, taxon_lumped=lump$taxon_lumped, Abundance=as.numeric(lump$Abundance)))
#lump.data$Abundance<-as.numeric(lump.data$Abundance)
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump.data %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
# spread Taxon column out into many columns filled with abundance/cover data
lump.comm <- lump.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
lump.comm
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump.data %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
lump.simple
## read data files
# all data
algae <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data_algae.csv", stringsAsFactors = FALSE)
# all metadata
algae_metadata <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" , stringsAsFactors = FALSE)
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv", stringsAsFactors = FALSE)
str(lump)
## Data cleaning for Analysis
# remove 2011 data
#algae_metadata <- algae_metadata[ algae_metadata$Year != "2011", ]
# remove Meay Channel
am <- algae_metadata[ algae_metadata$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
algae[ duplicated(algae), ] # generalize this to look at particular columns
am
algae
head(algae)
head(lump)
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump.data %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
lump.simple
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
ad.simple <- algae %>%
group_by( UID, taxon_lumped ) %>%
summarize( Abundance=sum(Abundance,na.rm=T))
# spread Taxon column out into many columns filled with abundance/cover data
ad.comm <- ad.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
ad.comm
#Add in row that has no seaweeds (West Beach High 2016 Q4)
ad.comm<-ungroup(ad.comm)
ad.comm<-add_row(ad.comm, UID="West Beach HIGH 2016 4")
ad.comm[is.na(ad.comm)] <- 0
ad.comm<-group_by(ad.comm, UID)
am$UID[ !(am$UID %in% ad.comm$UID) ]
ad[ ad$UID %in% am$UID[ !(am$UID %in% ad.comm$UID) ], ]
# restrict to rows selected in metadata
ad.comm <- ad.comm[ ad.comm$UID %in% am$UID, ]
##Check that the above code resulted in metadata and community
#files with the same number of rows (both should be 630 or 720 depending on setting above)
str(ad.comm)
str(am)
##Sort metadata and community matrix to be the same order
ad.comm<-ad.comm[order(match(ad.comm$UID, am$UID)),]
##Remove UID column from ad.comm
ad.comm<-as.data.frame(ad.comm[,-1])
##Separate community matrices by site
WB.comm <- ad.comm[am$Site=="West Beach",]
WB.meta <- am[am$Site=="West Beach",]
NB.comm <- ad.comm[am$Site=="North Beach",]
NB.meta <- am[am$Site=="North Beach",]
FB.comm <- ad.comm[am$Site=="Fifth Beach",]
FB.meta <- am[am$Site=="Fifth Beach",]
##Diversity indices
##Shannon-Weiner
WB.Shannon <- diversity(WB.comm)
NB.Shannon <- diversity(NB.comm)
FB.Shannon <- diversity(FB.comm)
#Simpson
WB.Simp <- diversity(WB.comm, index="simpson")
NB.Simp <- diversity(NB.comm, index="simpson")
FB.Simp <- diversity(FB.comm, index="simpson")
#Richness
WB.richness <- data.frame()
for (i in 1:length(WB.comm[,1])) {
sumsum<-sum(WB.comm[i,]>0)
WB.richness[i,1]<-sumsum
}
NB.richness <- data.frame()
for (i in 1:length(NB.comm[,1])) {
sumsum<-sum(NB.comm[i,]>0)
NB.richness[i,1]<-sumsum
}
FB.richness <- data.frame()
for (i in 1:length(FB.comm[,1])) {
sumsum<-sum(FB.comm[i,]>0)
FB.richness[i,1]<-sumsum
}
#Combine metadata and new diversity indices
WB.data<-as.data.frame(cbind(WB.meta, WB.Shannon, WB.Simp, WB.richness=as.numeric(unlist(WB.richness))))
NB.data<-cbind(NB.meta, NB.Shannon, NB.Simp, NB.richness=as.numeric(unlist(NB.richness)))
FB.data<-cbind(FB.meta, FB.Shannon, FB.Simp, FB.richness=as.numeric(unlist(FB.richness)))
##Plot species richness versus time
par(mfrow=c(3,1), mar=c(4,4,1,1))
boxplot(WB.richness~Year,data=WB.data[WB.data$Zone=="HIGH",], las=1)
boxplot(WB.richness~Year,data=WB.data[WB.data$Zone=="MID",], las=1)
boxplot(WB.richness~Year,data=WB.data[WB.data$Zone=="LOW",], las=1)
boxplot(NB.richness~Year,data=NB.data[NB.data$Zone=="HIGH",], las=1)
boxplot(NB.richness~Year,data=NB.data[NB.data$Zone=="MID",], las=1)
boxplot(NB.richness~Year,data=NB.data[NB.data$Zone=="LOW",], las=1)
boxplot(FB.richness~Year,data=FB.data[FB.data$Zone=="HIGH",], las=1)
boxplot(FB.richness~Year,data=FB.data[FB.data$Zone=="MID",], las=1)
boxplot(FB.richness~Year,data=FB.data[FB.data$Zone=="LOW",], las=1)
##Plot Shannon versus time
boxplot(WB.Shannon~Year,data=WB.data[WB.data$Zone=="HIGH",], las=1)
boxplot(WB.Shannon~Year,data=WB.data[WB.data$Zone=="MID",], las=1)
boxplot(WB.Shannon~Year,data=WB.data[WB.data$Zone=="LOW",], las=1)
boxplot(NB.Shannon~Year,data=NB.data[NB.data$Zone=="HIGH",], las=1)
boxplot(NB.Shannon~Year,data=NB.data[NB.data$Zone=="MID",], las=1)
boxplot(NB.Shannon~Year,data=NB.data[NB.data$Zone=="LOW",], las=1)
boxplot(FB.Shannon~Year,data=FB.data[FB.data$Zone=="HIGH",], las=1)
boxplot(FB.Shannon~Year,data=FB.data[FB.data$Zone=="MID",], las=1)
boxplot(FB.Shannon~Year,data=FB.data[FB.data$Zone=="LOW",], las=1)
##Plot Simpson versus time
boxplot(WB.Simp~Year,data=WB.data[WB.data$Zone=="HIGH",], las=1)
boxplot(WB.Simp~Year,data=WB.data[WB.data$Zone=="MID",], las=1)
boxplot(WB.Simp~Year,data=WB.data[WB.data$Zone=="LOW",], las=1)
boxplot(NB.Simp~Year,data=NB.data[NB.data$Zone=="HIGH",], las=1)
boxplot(NB.Simp~Year,data=NB.data[NB.data$Zone=="MID",], las=1)
boxplot(NB.Simp~Year,data=NB.data[NB.data$Zone=="LOW",], las=1)
boxplot(FB.Simp~Year,data=FB.data[FB.data$Zone=="HIGH",], las=1)
boxplot(FB.Simp~Year,data=FB.data[FB.data$Zone=="MID",], las=1)
boxplot(FB.Simp~Year,data=FB.data[FB.data$Zone=="LOW",], las=1)
##West Beach High Zone
WB.high2012 <- WB.comm[WB.meta$Zone=="HIGH"&WB.meta$Year==2012,]
WB.high2013 <- WB.comm[WB.meta$Zone=="HIGH"&WB.meta$Year==2013,]
WB.high2014 <- WB.comm[WB.meta$Zone=="HIGH"&WB.meta$Year==2014,]
WB.high2015 <- WB.comm[WB.meta$Zone=="HIGH"&WB.meta$Year==2015,]
WB.high2016 <- WB.comm[WB.meta$Zone=="HIGH"&WB.meta$Year==2016,]
WB.high2017 <- WB.comm[WB.meta$Zone=="HIGH"&WB.meta$Year==2017,]
z.high2012 <- specaccum(WB.high2012, method="random", permutations = 1000)
WB.high2018 <- WB.comm[WB.meta$Zone=="HIGH"&WB.meta$Year==2018,]
z.high2013 <- specaccum(WB.high2013, method="random", permutations = 1000)
kelps <- c("Alaria marginata", "Costaria costata", "Laminaria setchellii", "Laminaria yezoensis", "Macrocystis pyrifera", "Saccharina sessilis", "Saccharina latissima","Saccharina nigripes", "Egregia menziesii")
kelp.comm<-ad.comm[,kelps]
fucus.comm<-ad.comm[, "Fucus distichus"]
bare.rock<-lump.comm[,"Bare rock"]
head(kelp.comm)
total.kelp <- vector()
kelps <- c("Alaria marginata", "Costaria costata", "Laminaria setchellii", "Laminaria yezoensis", "Macrocystis pyrifera", "Saccharina sessilis", "Saccharina latissima","Saccharina nigripes", "Egregia menziesii")
kelp.comm<-ad.comm[,kelps]
fucus.comm<-ad.comm[, "Fucus distichus"]
bare.rock<-lump.comm[,"Bare rock"]
head(kelp.comm)
total.kelp <- vector()
for (i in 1:length(kelp.comm[,1])) {
sumsum<-sum(kelp.comm[i,])
total.kelp[i]<-sumsum
}
total.cover <- vector()
for (i in 1:length(ad.comm[,1])) {
sumsum<-sum(ad.comm[i,])
total.cover[i]<-sumsum
}
head(total.kelp)
total.kelp<-cbind(total.kelp, am, kelp.comm)
total.cover<-cbind(total.cover, total.kelp)
fucus.cover<-cbind(total.kelp, fucus.comm)
bare.rock.cover<-cbind(total.kelp, bare.rock)
kelp.summary<-summarySE(total.kelp, measurevar = "total.kelp", groupvars=c("Year", "Zone", "Site"))
lump$UID
View(lump$UID)
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump.data %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
lump.simple
group_by(lump.simple, UID, taxon_lumped)
str$lump.data
str(lump.data)
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
lump.simple
# spread Taxon column out into many columns filled with abundance/cover data
lump.comm <- lump.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
#Add in row that has no seaweeds (West Beach High 2016 Q4)
lump.comm<-ungroup(lump.comm)
#lump.comm<-add_row(lump.comm, UID="West Beach HIGH 2016 4")
lump.comm[is.na(lump.comm)] <- 0
lump.comm<-group_by(lump.comm, UID)
algae_metadata$UID[ !(algae_metadata$UID %in% lump.comm$UID) ]
lump.comm[ lump.comm$UID %in% algae_metadata$UID[ !(algae_metadata$UID %in% lump.comm$UID) ], ]
# restrict to rows selected in metadata
lump.comm <- lump.comm[ lump.comm$UID %in% algae_metadata$UID, ]
##Sort metadata and community matrix to be the same order
lump.comm<-lump.comm[order(match(lump.comm$UID, am$UID)),]
##Remove UID column from ad.comm
lump.comm<-as.data.frame(lump.comm[,-1])
library(Rmisc)
kelps <- c("Alaria marginata", "Costaria costata", "Laminaria setchellii", "Laminaria yezoensis", "Macrocystis pyrifera", "Saccharina sessilis", "Saccharina latissima","Saccharina nigripes", "Egregia menziesii")
kelp.comm<-ad.comm[,kelps]
fucus.comm<-ad.comm[, "Fucus distichus"]
bare.rock<-lump.comm[,"Bare rock"]
head(kelp.comm)
total.kelp <- vector()
for (i in 1:length(kelp.comm[,1])) {
sumsum<-sum(kelp.comm[i,])
total.kelp[i]<-sumsum
}
total.cover <- vector()
for (i in 1:length(ad.comm[,1])) {
sumsum<-sum(ad.comm[i,])
total.cover[i]<-sumsum
}
head(total.kelp)
total.kelp<-cbind(total.kelp, am, kelp.comm)
total.cover<-cbind(total.cover, total.kelp)
fucus.cover<-cbind(total.kelp, fucus.comm)
bare.rock.cover<-cbind(total.kelp, bare.rock)
kelp.summary<-summarySE(total.kelp, measurevar = "total.kelp", groupvars=c("Year", "Zone", "Site"))
alaria.summary<-summarySE(total.kelp, measurevar = "Alaria marginata", groupvars=c("Year", "Zone", "Site"))
egregia.summary<-summarySE(total.kelp, measurevar = "Egregia menziesii", groupvars=c("Year", "Zone", "Site"))
macrocystis.summary<-summarySE(total.kelp, measurevar = "Macrocystis pyrifera", groupvars=c("Year", "Zone", "Site"))
saccharina.summary<-summarySE(total.kelp, measurevar = "Saccharina sessilis", groupvars=c("Year", "Zone", "Site"))
costaria.summary<-summarySE(total.kelp, measurevar = "Costaria costata", groupvars=c("Year", "Zone", "Site"))
laminaria.yez.summary<-summarySE(total.kelp, measurevar = "Laminaria yezoensis", groupvars=c("Year", "Zone", "Site"))
saccharina.nig.summary<-summarySE(total.kelp, measurevar = "Saccharina nigripes", groupvars=c("Year", "Zone", "Site"))
total.summary<-summarySE(total.cover, measurevar = "total.cover", groupvars=c("Year", "Zone", "Site"))
fucus.summary<-summarySE(fucus.cover, measurevar = "fucus.comm", groupvars=c("Year", "Zone", "Site"))
bare.rock.cover<-cbind(total.kelp, bare.rock)
bare.rock.cover<-cbind(total.kelp, bare.rock)
total.kelp<-cbind(total.kelp, am, kelp.comm)
total.cover<-cbind(total.cover, total.kelp)
fucus.cover<-cbind(total.kelp, fucus.comm)
bare.rock.cover<-cbind(total.kelp, bare.rock)
bare.summary<-summarySE(lump.comm, measurevar="Bare rock", groupvars=c("Year", "Zone", "Site"))
lump.comm
ad.comm
total.kelp
View(lump.data)
View(lump)
bare.comm<-lump.comm[,"Bare rock"]
View(bare.comm)
## read data files
# all data
algae <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data_algae.csv", stringsAsFactors = FALSE)
# all metadata
algae_metadata <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" , stringsAsFactors = FALSE)
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv", stringsAsFactors = FALSE)
## Data cleaning for Analysis
# remove 2011 data
#algae_metadata <- algae_metadata[ algae_metadata$Year != "2011", ]
# remove Meay Channel
am <- algae_metadata[ algae_metadata$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
algae[ duplicated(algae), ] # generalize this to look at particular columns
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
# spread Taxon column out into many columns filled with abundance/cover data
lump.comm <- lump.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
library( tidyverse )
# Data
data <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data.csv", stringsAsFactors = FALSE )
#metadata
meta<-read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv")
## read data files
# all data
algae <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data_algae.csv", stringsAsFactors = FALSE)
# all metadata
algae_metadata <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" , stringsAsFactors = FALSE)
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv", stringsAsFactors = FALSE)
## Data cleaning for Analysis
# remove 2011 data
#algae_metadata <- algae_metadata[ algae_metadata$Year != "2011", ]
# remove Meay Channel
am <- algae_metadata[ algae_metadata$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
algae[ duplicated(algae), ] # generalize this to look at particular columns
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
# spread Taxon column out into many columns filled with abundance/cover data
lump.comm <- lump.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
#Add in row that has no seaweeds (West Beach High 2016 Q4)
lump.comm<-ungroup(lump.comm)
#lump.comm<-add_row(lump.comm, UID="West Beach HIGH 2016 4")
lump.comm[is.na(lump.comm)] <- 0
lump.comm<-group_by(lump.comm, UID)
am$UID[ !(am$UID %in% lump.comm$UID) ]
lump.comm[ lump.comm$UID %in% am$UID[ !(am$UID %in% lump.comm$UID) ], ]
# restrict to rows selected in metadata
lump.comm <- lump.comm[ lump.comm$UID %in% am$UID, ]
##Sort metadata and community matrix to be the same order
lump.comm<-lump.comm[order(match(lump.comm$UID, am$UID)),]
##Remove UID column from ad.comm
lump.comm<-as.data.frame(lump.comm[,-1])
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
ad.simple <- algae %>%
group_by( UID, taxon_lumped ) %>%
summarize( Abundance=sum(Abundance,na.rm=T))
# spread Taxon column out into many columns filled with abundance/cover data
ad.comm <- ad.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
#Add in row that has no seaweeds (West Beach High 2016 Q4)
ad.comm<-ungroup(ad.comm)
ad.comm<-add_row(ad.comm, UID="West Beach HIGH 2016 4")
ad.comm[is.na(ad.comm)] <- 0
ad.comm<-group_by(ad.comm, UID)
am$UID[ !(am$UID %in% ad.comm$UID) ]
ad[ ad$UID %in% am$UID[ !(am$UID %in% ad.comm$UID) ], ]
# restrict to rows selected in metadata
ad.comm <- ad.comm[ ad.comm$UID %in% am$UID, ]
##Check that the above code resulted in metadata and community
#files with the same number of rows (both should be 630 or 720 depending on setting above)
str(ad.comm)
str(am)
##Sort metadata and community matrix to be the same order
ad.comm<-ad.comm[order(match(ad.comm$UID, am$UID)),]
##Remove UID column from ad.comm
ad.comm<-as.data.frame(ad.comm[,-1])
##Separate community matrices by site
WB.comm <- ad.comm[am$Site=="West Beach",]
WB.meta <- am[am$Site=="West Beach",]
NB.comm <- ad.comm[am$Site=="North Beach",]
NB.meta <- am[am$Site=="North Beach",]
FB.comm <- ad.comm[am$Site=="Fifth Beach",]
FB.meta <- am[am$Site=="Fifth Beach",]
##Diversity indices
##Shannon-Weiner
WB.Shannon <- diversity(WB.comm)
NB.Shannon <- diversity(NB.comm)
FB.Shannon <- diversity(FB.comm)
#Simpson
WB.Simp <- diversity(WB.comm, index="simpson")
kelps <- c("Alaria marginata", "Costaria costata", "Laminaria setchellii", "Laminaria yezoensis", "Macrocystis pyrifera", "Saccharina sessilis", "Saccharina latissima","Saccharina nigripes", "Egregia menziesii")
kelp.comm<-ad.comm[,kelps]
fucus.comm<-ad.comm[, "Fucus distichus"]
bare.comm<-lump.comm[,"Bare rock"]
head(kelp.comm)
total.kelp <- vector()
for (i in 1:length(kelp.comm[,1])) {
sumsum<-sum(kelp.comm[i,])
total.kelp[i]<-sumsum
}
total.cover <- vector()
for (i in 1:length(ad.comm[,1])) {
sumsum<-sum(ad.comm[i,])
total.cover[i]<-sumsum
}
head(total.kelp)
total.kelp<-cbind(total.kelp, am, kelp.comm)
total.cover<-cbind(total.cover, total.kelp)
bare.comm<-lump.comm[,"Bare rock"]
bare.rock.cover<-cbind(bare.comm, total.kelp)
bare.summary<-summarySE(lump.comm, measurevar="Bare rock", groupvars=c("Year", "Zone", "Site"))
library(Rmisc)
bare.summary<-summarySE(lump.comm, measurevar="Bare rock", groupvars=c("Year", "Zone", "Site"))
bare.summary<-summarySE(bare.rock.cover, measurevar="Bare rock", groupvars=c("Year", "Zone", "Site"))
bare.rock.cover
##Bare Rock
plot(`bare.comm`~Year,data=rock.summary[rock.summary$Site=="West Beach"&rock.summary$Zone=="HIGH",], pch=19, ylim=c(0,50), las=1, col="blue", cex=2)
lines(`bare.comm`~Year,data=rock.summary[rock.summary$Site=="West Beach"&rock.summary$Zone=="HIGH",], pch=19,  las=1, col="blue", lwd=3)
rock.summary<-summarySE(bare.rock.cover, measurevar="bare.comm", groupvars=c("Year", "Zone", "Site"))
##Bare Rock
plot(`bare.comm`~Year,data=rock.summary[rock.summary$Site=="West Beach"&rock.summary$Zone=="HIGH",], pch=19, ylim=c(0,50), las=1, col="blue", cex=2)
lines(`bare.comm`~Year,data=rock.summary[rock.summary$Site=="West Beach"&rock.summary$Zone=="HIGH",], pch=19,  las=1, col="blue", lwd=3)
points(`bare.comm`~Year,data=rock.summary[rock.summary$Site=="North Beach"&rock.summary$Zone=="HIGH",], pch=19,  las=1, col="blue", cex=2)
##Bare Rock
plot(`bare.comm`~Year,data=rock.summary[rock.summary$Site=="West Beach"&rock.summary$Zone=="HIGH",], pch=19, ylim=c(0,80), las=1, col="blue", cex=2)
##Bare Rock
plot(`bare.comm`~Year,data=rock.summary[rock.summary$Site=="West Beach"&rock.summary$Zone=="HIGH",], pch=19, ylim=c(0,90), las=1, col="blue", cex=2)
## read data files
# all data
algae <- read.csv( "Data/R Code/Output from R/Martone_Hakai_data_algae.csv", stringsAsFactors = FALSE)
# all metadata
algae_metadata <- read.csv("Data/R Code/Output from R/Martone_Hakai_metadata.csv" , stringsAsFactors = FALSE)
#lumped data
lump<-read.csv("Data/R Code/Output from R/Martone_Hakai_data_lumped.csv", stringsAsFactors = FALSE)
## Data cleaning for Analysis
# remove 2011 data
algae_metadata <- algae_metadata[ algae_metadata$Year != "2011", ]
# remove Meay Channel
am <- algae_metadata[ algae_metadata$Site != "Meay Channel", ]
# add up all taxa that appear more than once in a single quadrat (e.g. barnacles or Hildenbrandia) -- go back to datasheets on some of these?
algae[ duplicated(algae), ] # generalize this to look at particular columns
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
# spread Taxon column out into many columns filled with abundance/cover data
lump.comm <- lump.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
#Add in row that has no seaweeds (West Beach High 2016 Q4)
lump.comm<-ungroup(lump.comm)
#lump.comm<-add_row(lump.comm, UID="West Beach HIGH 2016 4")
lump.comm[is.na(lump.comm)] <- 0
lump.comm<-group_by(lump.comm, UID)
am$UID[ !(am$UID %in% lump.comm$UID) ]
# spread out all of the community data so sample (site,height,year,quadrat) are rows and species are columns
# add together taxa that are not unique to each quadrat
lump.simple <- lump %>%
group_by( UID, taxon_lumped ) %>%
summarize(Abundance=sum(Abundance,na.rm=T))
# spread Taxon column out into many columns filled with abundance/cover data
lump.comm <- lump.simple %>%
spread(taxon_lumped, Abundance, fill=0 )
